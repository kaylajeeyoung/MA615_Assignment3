---
title: "Hurricane Andrew"
author: "Kayla Choi"
date: "11/17/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
pacman::p_load(tidyverse,
               drat,
               hurricaneexposuredata,
               hurricaneexposure,
               weathermetrics)

addRepo("geanders")

data("hurr_tracks")
data("rain")

head(hurr_tracks,15)
head(rain, 15)
```


```{r}
hmapper <- function(hurr){
    
    rmap = map_counties(storm = hurr, metric = "rainfall") +
            ggtitle(hurr) +
            theme(plot.title = element_text(hjust = 0.5))

    wmap = map_counties(storm = hurr, metric = "wind") +
            ggtitle(hurr) +
            theme(plot.title = element_text(hjust = 0.5))

    expos = map_rain_exposure(storm =hurr, 
                  rain_limit = 175, 
                  dist_limit = 500, 
                  days_included =-5:3) +
                    ggtitle(hurr) +
                    theme(plot.title = element_text(hjust = 0.5))

    ml <-  list(rmap, wmap, expos)
    names(ml) <- c("rmap", "wmap", "expos")
    
    return(ml)
}
 
mapps <- hmapper("Andrew-1992") 


mapps$rmap
mapps$wmap
mapps$expos
```

```{r}
map_counties(storm = "Andrew-1992", metric= "wind", days_included = -5:5) +
    ggtitle("Wind Andrew")

map_counties(storm = "Andrew-1992", metric = "rainfall", days_included = -5:5) +
    ggtitle("rain Andrew")

map_counties(storm = "Andrew-1992", metric= "rainfall", days_included = -1:0) +
    ggtitle("Rain Andrew") #rainfall
```

##Read the buoy data
```{r}
st41016 <- read.table(url("https://www.ndbc.noaa.gov/histsearch.php?station=41016&year=1992&f1=wspd&t1a=ge&v1a=1&t1b=&v1b=&c1=and&f2=wtmp&t2a=ge&v2a=1&t2b=&v2b=&c2=&f3=&t3a=&v3a=&t3b=&v3b=&mode=data"), skip = 2, header = TRUE)
```


